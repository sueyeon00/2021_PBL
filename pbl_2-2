#define _CRT_SECURE_NO_WARNINGS
#include<stdio.h>
#include<stdlib.h>
#include<string.h>

typedef char element[100];
typedef struct DListNode {   //이중연결노드타입
	element data;
	struct DListNode* llink;
	struct DListNode* rlink;
}DListNode;

DListNode* current;     //현재실행중인 곡
//전역변수에다가 current 라는 변수를 만듦

//이중연결리스트를 초기화
void init(DListNode* phead) {
	phead->llink = phead;
	phead->rlink = phead; 
}

//이중연결리스트의 노드를 출력
void print_dlist(DListNode* phead) {//매개변수로 phead를 받음 
	DListNode* p;     //포인터 p 만듦
	for (p = phead->rlink; p != phead; p = p->rlink) {
	//p에 phead의 rlink(1000번지)   //phead = 5000 //  p = 2000, 3000, 4000 ...반복
		if (p == current)  // ㅇㅇtrue p->data 값 = F (<--p = F의주소값)
			printf("<- | #%s# | ->", p->data);
		else
			printf("<- | %s | ->", p->data);
	}
	printf("\n");
}
//새로운 데이터를 노드 before 의 오른쪽에 삽입한다.
void dinsert(DListNode* before, element data) {
	DListNode* newnode = (DListNode*)malloc(sizeof(DListNode));
	strcpy(newnode->data, data); //data 값을 newnode -> data 에 복사저장
	newnode->llink = before;
	newnode->rlink = before->rlink;
	before->rlink->llink = newnode;
	before->rlink = newnode;
}
//노드 remove를 삭제한다
void ddelete(DListNode* head, DListNode* removed) {
	if (removed == head)return;
	removed->llink->rlink = removed->rlink;
	removed->rlink->llink = removed->llink;
	free(removed);
}

int main(void) {
	char ch;
	DListNode* head = (DListNode*)malloc(sizeof(DListNode));
	//head 노드를 만들고 초기화 (자기자신을 가리킴)
	init(head);

	dinsert(head, "Mamamia");     //삽입
	dinsert(head, "Dancing Queen");
	dinsert(head, "Fernando");
	// head - F - D - M  이 순서로 만들어짐 (이중연결리스트로)

	current = head->rlink;  
	//current 에다가 head의 rlink (--> F의 주소지를 가리킴/1000번지로 가정)
	print_dlist(head); //-> 위로 가보면

	do {
		printf("\n명령어를 입력하시오(<,>,q): ");
		ch = getchar();  // 한글자만 입력받겠다 함수이용
		if (ch == '<') {
			current = current->llink;     //왼쪽으로 (F -> head노드(5000번지))
			if (current == head)      //같으면
				current = current->llink;  //
		}
		else if (ch == '>') {
			current = current->rlink;
			if (current == head)
				current = current->rlink;
		}
		print_dlist(head);
		getchar();
	} while (ch != 'q');  //q가 나오면 종료
	return 0;
}
